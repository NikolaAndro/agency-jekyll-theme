---
layout: kitchen_mealplan_generator
lang: eng
---

<div class="mealplan_generator_container" id="mealplan-page">
    <h1>Meal Plan Generator</h1>
    
    <h2 style="text-align: left; font-weight: bold; margin-bottom: 20px;">STEP 1 :  Calculate your BMR (Basic Metabolic Rate - he amount of energy expended per day at rest) :</h2>
   
    <div id="topmenu">
        <ul>
            <li id="menuon"><a onclick="return popMenu('standard',1);">US Units</a></li>
            <li><a onclick="return popMenu('metric',1);">Metric Units</a></li>
        </ul>
    </div>
    <div class="panel2" style="padding:10px;">
        <form action="calorie-calculator.html" name="calform">
            <table id="calinputtable" width="420">
                <tr>
                    <td width="50">Age</td>
                    <td width="370">
                        <div class="input-row">
                            <input type="number" name="cage" id="cage" value="25" class="inhalf" onkeyup="iptfieldCheck(this, 'r', 'pn');"  inputmode="numeric">
                            <span style="display: flex; align-items: center; height: 100%;">ages 15 - 80</span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>Gender</td>
                    <td>
                        <div class="input-row">
                            <label for="csex1" class="cbcontainer" style="margin-right: 10%;">
                                <input type="radio" name="csex" id="csex1" value="m" checked>
                                <span class="rbmark"></span> male
                            </label>
                            <label for="csex2" class="cbcontainer">
                                <input type="radio" name="csex" id="csex2" value="f">
                                <span class="rbmark"></span> female
                            </label>
                        </div>
                    </td>
                </tr>
            </table>
            <table width="420" id="standardheightweight" style="display: none;">
                <tr>
                    <td width="50">Height</td>
                    <td width="370">
                        <div class="input-container">
                            <div class="input-row" style="margin-right: 30px !important;">
                                <input type="number" name="cheightfeet" id="cheightfeet" value="5" class="inhalf inuifoot" onkeyup="iptfieldCheck(this, '', 'pzn');" inputmode="numeric">
                                <span class="inuifootspan">feet</span>
                            </div>
                            <div class="input-row">
                                <input type="number" name="cheightinch" id="cheightinch" value="10" class="inhalf inuiinch" onkeyup="iptfieldCheck(this, '', 'pzn');" inputmode="numeric">
                                <span class="inuiinchspan">inches</span>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>Weight</td>
                    <td>
                        <div class="input-row">
                            <input type="number" name="cpound" id="cpound" value="165" class="infull inuipound" onkeyup="iptfieldCheck(this, 'r', 'pn');" inputmode="numeric">
                            <span class="inuipoundspan">pounds</span>
                        </div>
                    </td>
                </tr>
            </table>
            <table width="420" id="metricheightweight" style="display: block;">
                <tr>
                    <td width="50">Height</td>
                    <td width="370">
                        <div class="input-row">
                            <input type="number" name="cheightmeter" id="cheightmeter" value="180" class="infull inuick" onkeyup="iptfieldCheck(this, 'r', 'pn');" inputmode="numeric">
                            <span class="inuickspan">cm</span>
                        </div>
                    </td>
                </tr>
                <tr id="metricweight">
                    <td>Weight</td>
                    <td>
                        <div class="input-row">
                            <input type="number" name="ckg" id="ckg" value="65" class="infull inuick" onkeyup="iptfieldCheck(this, 'r', 'pn');" inputmode="numeric">
                            <span class="inuickspan">kg</span>
                        </div>
                    </td>
                </tr>
            </table>
            <table width="500">
                <tr>
                    <td width="50">Activity</td>
                    <td width="450">
                        <div class="custom-select-wrapper">
                            <select id="cactivity" name="cactivity" class="custom-select">
                                <option value="1">Basal Metabolic Rate (BMR)</option>
                                <option value="1.2">Sedentary: little or no exercise</option>
                                <option value="1.375">Light: exercise 1-3 times/week</option>
                                <option value="1.465" selected>Moderate: exercise 4-5 times/week</option>
                                <option value="1.55">Active: daily exercise or intense exercise 3-4 times/week</option>
                                <option value="1.725">Very Active: intense exercise 6-7 times/week</option>
                                <option value="1.9">Extra Active: very intense exercise daily, or physical job</option>
                            </select>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td width="50">&nbsp;</td>
                    <td width="450">
                        <div id="ccsettingtitle" style="margin: 10px 0;">
                            <b><a id="settingsToggle" onclick="return cshmoreoption(1);">+ Settings</a></b>
                        </div>
                        <div id="ccsettingcontent" style="display: none;">
                            <input type="hidden" name="cmop" id="cmoreoption" value="0">
                            <div style="padding-top:15px;"><b>BMR estimation formula:</b></div>
                            <div>
                                <div class="input-row" style="justify-content: left;"><label for="cformula1" class="cbcontainer" style="margin-bottom: 0px;"><input type="radio" name="cformula" id="cformula1" value="m" checked><span class="rbmark"></span> Mifflin St Jeor</label></div>
                                <div class="input-row" style="justify-content: left;"><label for="cformula3" class="cbcontainer" style="margin-bottom: 0px;"><input type="radio" name="cformula" id="cformula3" value="h"><span class="rbmark"></span> Revised Harris-Benedict</label></div>
                                <div class="input-row" style="justify-content: left;">
                                    <label for="cformula2" class="cbcontainer" style="margin-bottom: 0px;">
                                        <input type="radio" name="cformula" id="cformula2" value="k">
                                        <span class="rbmark"></span> Katch-McArdle
                                    </label> 
                                    &nbsp;&nbsp;&nbsp; 
                                    <a href="/body-fat-calculator.html">
                                        Body Fat:
                                    </a> 
                                    &nbsp;&nbsp;
                                    <input type="text" name="cfatpct" value="20" onkeyup="iptfieldCheck(this, '', 'pn');">                                        
                                    <span class="inuickspan">%</span> 
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td width="50">&nbsp;</td>
                    <td width="450">
                        <input name="printit" value="0" type="hidden">
                        <input type="hidden" name="ctype" id="ctype" value="metric">
                        <div style="display: flex; gap: 10px;">
                            <input id="bmr-calculate-btn" type="submit" name="x" value="Calculate" class="calculate-btn" onclick="calculateBMR(event);">
                            <input id="bmr-clean-btn" type="button" value="Clear" onclick="clearForm(document.calform);" style="background-color: #444;font-weight: bold;">
                        </div>
                        <div id="bmr-result"></div>
                    </td>
                </tr>
            </table>
        </form>
    </div>


    <h2 style="text-align: left; font-weight: bold; margin-bottom: 20px;">STEP 2 :  Enter your daily macronutrient goals:</h2>

    

    <form id="macro-form">
        <div id="calorieGoalDiv">
            <label for="calorie-goal" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white" style="font-size: 14px; width: 200px; margin-right: 10px;">Calorie Goal (kcal):</label>
            <input type="number" id="calorie-goal" name="calorie-goal" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" required style="font-size: 14px; width: 150px;" inputmode="numeric">
            <button type="button" id="get-suggestions" class="bg-blue-500 text-white rounded-lg p-2.5" style="font-size: 14px; margin-left: 20px; background-color: #f0c117; color: black; font-weight: bold;" onclick="getSuggestions()">Get Suggestions</button>
        </div>

        <div class="instructions-container">
            <table class="instructions-table">
                <tr>
                    <td class="instruction-title">Protein Instructions:</td>
                    <td class="instruction-detail">1 g of protein per lb of body mass</td>
                </tr>
                <tr>
                    <td class="instruction-title">Fat Instructions:</td>
                    <td class="instruction-detail">0.3 g of fat per lb of body weight at minimum</td>
                </tr>
                <tr>
                    <td class="instruction-title">Carbs Instructions:</td>
                    <td class="instruction-detail">The rest are carbs</td>
                </tr>
            </table>
        </div>
        <div class="macro-container">
            <div class="macro-goals">
                <div class="macro-goal">
                    <label for="protein" class="macro-label">Protein Goal (g):</label>
                    <input type="number" id="protein" name="protein" aria-describedby="protein-helper" class="macro-input" required inputmode="numeric">
                </div>
                <div class="macro-goal">
                    <label for="carbs" class="macro-label">Carbs Goal (g):</label>
                    <input type="number" id="carbs" name="carbs" aria-describedby="carbs-helper" class="macro-input" required inputmode="numeric">
                </div>
                <div class="macro-goal">
                    <label for="fat" class="macro-label">Fat Goal (g):</label>
                    <input type="number" id="fat" name="fat" aria-describedby="fat-helper" class="macro-input" required inputmode="numeric">
                </div>
            </div>
            <div class="macro-percentages">
                <div class="macro-percentage">
                    <span class="macro-percentage-label">Protein (%):</span>
                    <span id="protein-percentage" class="macro-value">0%</span>
                </div>
                <div class="macro-percentage">
                    <span class="macro-percentage-label">Carbs (%):</span>
                    <span id="carbs-percentage" class="macro-value">0%</span>
                </div>
                <div class="macro-percentage">
                    <span class="macro-percentage-label">Fat (%):</span>
                    <span id="fat-percentage" class="macro-value">0%</span>
                </div>
            </div>
        </div>
        <div class="note" >
            <p style="font-size: 1.8em"><b>NOTE:</b> If you manually adjust the macronutrient goals, you must click the <b>"Calculate Total Calories"</b> button to recalculate the total calories.</p>
        </div>

        <div style="margin-top: 20px;"></div>
            <button type="button" id="update-total-calories" class="bg-blue-500 text-white rounded-lg p-2.5" style="font-size: 1.95em; padding: 15px 100px 15px 100px; margin-bottom: 30px; background-color: #f0c117; color: black; font-weight: bold;">Calculate Total Calories</button>
        </div>
        <div class="total-calories-container">
            <!-- <label for="total-calories" class="total-calories-label">Total Calories Goal:</label> -->
            <span class="total-calories-label">Total Calories Goal:</span>
            <span id="total-calories" class="total-calories-value">0</span>
        </div>
    </form>

    <!-- Section that displays all meals for breakfast, lunchm dinner, and snacks -->
    <div id="meal-selections">
        <h2 style="text-align: left; font-weight: bold; margin-bottom: 20px;">STEP 3 : Select your meals:</h2>
        <div class="meal-category">
            <div class="meal-header">
                <h3>Breakfast</h3>
                <button type="button" class="add-food-btn" data-meal-type="breakfast">
                    <i class="fas fa-plus"></i> Add Food
                </button>
            </div>
            <div class="meal-options" id="breakfast-options">
                <!-- Breakfast meal options will be dynamically added here -->
            </div>
        </div>
        <div class="meal-category">
            <div class="meal-header">
                <h3>Lunch</h3>
                <button type="button" class="add-food-btn" data-meal-type="lunch">
                    <i class="fas fa-plus"></i> Add Food
                </button>
            </div>
            <div class="meal-options" id="lunch-options">
            </div>
        </div>
        <div class="meal-category">
            <div class="meal-header">
                <h3>Dinner</h3>
                <button type="button" class="add-food-btn" data-meal-type="dinner">
                    <i class="fas fa-plus"></i> Add Food
                </button>
            </div>
            <div class="meal-options" id="dinner-options">
            </div>
        </div>
        <div class="meal-category">
            <div class="meal-header">
                <h3>Snacks</h3>
                <button type="button" class="add-food-btn" data-meal-type="snacks">
                    <i class="fas fa-plus"></i> Add Food
                </button>
            </div>
            <div class="meal-options" id="snacks-options">
            </div>
        </div>

        <style>
            #addFoodContent{
                margin: 15% 5%;
                max-width: 700px;
                width: 100%;
            }
            .meal-header {
                display: flex;
                align-items: center;
                gap: 1rem;
                margin-bottom: 1rem;
            }
            
            .add-food-btn {
                padding: 0.5rem 1rem;
                background-color: #f0c117;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-weight: bold;
                font-size: 30px;
                margin-left: auto;
                margin-right: 5%
            }
            .form-group {
                margin-bottom: 1rem;
            }
            
            .form-group label {
                display: block;
                margin-bottom: 0.5rem;
                font-size: 2em;
            }
            
            .form-group input,
            .form-group textarea {
                width: 100%;
                padding: 0.5rem;
            }
            
            .ingredient-entry {
                display: flex;
                align-items: center;
                gap: 10px;
                margin-bottom: 15px;
                width: 100%;
            }

            .ingredient-entry input {
                padding: 8px 12px;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-size: 1.5em;
                transition: border-color 0.3s ease;
            }

            .ingredient-entry input:focus {
                outline: none;
                border-color: #f0c117;
                box-shadow: 0 0 0 2px rgba(240, 193, 23, 0.2);
            }

            .ingredient-entry .ingredient-name {
                flex: 3;
            }

            .ingredient-entry .ingredient-amount {
                flex: 1;
                max-width: 120px; /* Adjust as needed */
            }

            .ingredient-entry .ingredient-unit {
                flex: 1;
                max-width: 150px; /* Adjust as needed */
            }

            #ingredients h3 {
                font-size: 2em;
                font-weight: bold;
                text-align: center;
                margin-bottom: 20px;
            }
            #addNewFoodTitle{
                text-align: center;
            }

            #addFoodModal .modal-content{
                background-color: #e4b100;
            }

            #addIngredient, #saveFood{
                background-color: black;
                color: white;
                font-weight: bold;
                font-size: 1.5em;
                padding: 10px 20px;
                margin-bottom: 20px;
            }
            .addFoodButtons {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-top: 20px;
            }
            .remove-ingredient {
                background-color: #ff4444;
                color: white;
                border: none;
                border-radius: 4px;
                padding: 8px 15px;
                cursor: pointer;
                font-weight: bold;
                font-size: 1.5em;
                transition: background-color 0.3s ease;
            }

            .remove-ingredient:hover {
                background-color: #cc0000;
            }
      
            .upload-btn {
                padding: 0.5rem 1rem;
                background-color: black;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-weight: bold;
                font-size: 1.5em;
            }

            .image-path-display {
                margin-left: 10px;
                font-size: 1em;
                color: #333;
                font-size: 1.5em;
            }

            #foodImageGroup {
                display: flex;
                align-items: center;
                gap: 20px;
                margin-top: 25px;
                margin-bottom: 20px;

            }

            #addFoodForm input{
                padding-left: 10px;
                font-size: 24px;
            }
        </style>

        <!-- Add Food Modal -->
        <div id="addFoodModal" class="modal">
            <div class="modal-content" id="addFoodContent">
                <span class="close">&times;</span>
                <h2 id="addNewFoodTitle">Add New Food</h2>
                <form id="addFoodForm">
                    <input type="hidden" id="mealType">
                    <div class="form-group">
                        <label for="foodName">Name:</label>
                        <input type="text" id="foodName" required>
                    </div>
                    <div class="form-group" id="foodImageGroup">
                        <label for="foodImage">Image Path:</label>
                        <input type="file" id="foodImage" accept="image/*" style="display: none;" required>
                        <button type="button" id="uploadImageButton" class="upload-btn">Upload Image</button>
                        <span id="imagePathDisplay" class="image-path-display">No file chosen</span>
                    </div>
                    <div class="form-group">
                        <label for="foodProtein">Protein (g):</label>
                        <input type="number" id="foodProtein" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="foodCarbs">Carbs (g):</label>
                        <input type="number" id="foodCarbs" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="foodFat">Fat (g):</label>
                        <input type="number" id="foodFat" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="foodCalories">Calories:</label>
                        <input type="number" id="foodCalories" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="foodDescription">Description:</label>
                        <textarea id="foodDescription" required></textarea>
                    </div>
                    <div id="ingredients">
                        <h3>Ingredients</h3>
                        <div class="ingredient-entry">
                            <input type="text" class="ingredient-name" placeholder="Name" required>
                            <input type="number" class="ingredient-amount" placeholder="Amount" required>
                            <input type="text" class="ingredient-unit" placeholder="Unit" required>
                            <button type="button" class="remove-ingredient">Remove</button>
                        </div> 
                    </div>
                    <div class="addFoodButtons">
                        <button type="button" id="addIngredient">Add Another Ingredient</button>
                        <button type="submit" id="saveFood">Save Food</button>
                    </div>
                </form>
    
            </div>
        </div>
    </div>

    <div id="meal-sections" style="display:none;"></div>

    <div id="mealModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="mealName"></h2>
            <p id="mealDescription"></p><br>
            <img id="mealDescriptionImage" src="" alt="Description Image" style="display: none; max-width: 100%; margin-top: 10px;">
        </div>
    </div>

    <div id="quantityModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Enter Quantity</h2>
            <div style="margin-bottom: 10px; display: flex; align-items: center; justify-content: center; max-width: 300px; margin: 0 auto;">
                <input type="number" id="quantityInput" min="0.1" step="0.1" value="1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" required inputmode="numeric" style="font-size: 2em; margin-right: 10px;">
                <button id="quantitySubmit" class="bg-blue-500 text-white rounded-lg p-2.5" style="font-size: 14px; width: 100px; background-color: #fed136; margin-left: 20px;">Add</button>
            </div>
        </div>
    </div>

    <h2 class="step-heading">STEP 4 : Generate your grocery list:</h2>
    <div class="days-input-container">
        <label for="days" class="days-label">Number of Days:</label>
        <input type="number" id="days" name="days" class="days-input" required inputmode="numeric">
        <button type="button" id="generate-grocery-list" class="generate-button" onclick="generateGroceryList()">
            <i class="fas fa-list"></i> Generate Grocery List
        </button>
    </div>
    <div id="grocery-list" class="grocery-list"></div>
    <div class="grocery-buttons-container">
        <button type="button" id="print-grocery-list" class="grocery-button" onclick="printGroceryList()">
            <i class="fas fa-print"></i> Print Grocery List
        </button>
        <button type="button" id="share-grocery-list" class="grocery-button" onclick="exportGroceryList()">
            <i class="fas fa-share-alt"></i> Share Grocery List
        </button>
        <button type="button" id="open-grocery-list" class="grocery-button" onclick="openGroceryList()">
            <i class="fas fa-external-link-alt"></i> Open Grocery List in New Tab
        </button>
    </div>

    <script src="{{ site.baseurl }}/kitchen/eng/js/mealplan_generator/step_1_bmr.js"></script>
    <script src="{{ site.baseurl }}/kitchen/eng/js/mealplan_generator/step_2_macros.js"></script>
    <script src="{{ site.baseurl }}/kitchen/eng/js/mealplan_generator/step_3_foodSelection.js"></script>
    <script src="{{ site.baseurl }}/kitchen/eng/js/mealplan_generator/step_4_groceries.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const uploadImageButton = document.getElementById('uploadImageButton');
            const foodImageInput = document.getElementById('foodImage');
            const imagePathDisplay = document.getElementById('imagePathDisplay');

            uploadImageButton.addEventListener('click', () => {
                foodImageInput.click();
            });

            foodImageInput.addEventListener('change', () => {
                const file = foodImageInput.files[0];
                if (file) {
                    imagePathDisplay.textContent = file.name;
                } else {
                    imagePathDisplay.textContent = 'No file chosen';
                }
            });
            
            const addFoodModal = document.getElementById('addFoodModal');
            const addIngredientBtn = document.getElementById('addIngredient');
            const form = document.getElementById('addFoodForm');
            const mealTypeInput = document.getElementById('mealType');
        
            // Add click handlers for all add food buttons
            document.querySelectorAll('.add-food-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    mealTypeInput.value = btn.dataset.mealType;
                    addFoodModal.style.display = 'block';
                });
            });
        
            addIngredientBtn.addEventListener('click', () => {
                const ingredientsDiv = document.getElementById('ingredients');
                const newIngredient = document.createElement('div');
                newIngredient.className = 'ingredient-entry';
                newIngredient.innerHTML = `
                    <input type="text" class="ingredient-name" placeholder="Name" required>
                    <input type="number" class="ingredient-amount" placeholder="Amount" required>
                    <input type="text" class="ingredient-unit" placeholder="Unit" required>
                    <button type="button" class="remove-ingredient">Remove</button>
                `;
                ingredientsDiv.appendChild(newIngredient);
            });
        
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-ingredient')) {
                    e.target.parentElement.remove();
                }
            });
        
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const foodData = {
                    name: document.getElementById('foodName').value,
                    image: document.getElementById('foodImage').value,
                    protein: parseFloat(document.getElementById('foodProtein').value),
                    carbs: parseFloat(document.getElementById('foodCarbs').value),
                    fat: parseFloat(document.getElementById('foodFat').value),
                    calories: parseFloat(document.getElementById('foodCalories').value),
                    description: document.getElementById('foodDescription').value,
                    ingredients: Array.from(document.querySelectorAll('.ingredient-entry')).map(entry => ({
                        name: entry.querySelector('.ingredient-name').value,
                        amount: parseFloat(entry.querySelector('.ingredient-amount').value),
                        unit: entry.querySelector('.ingredient-unit').value
                    }))
                };
        
                try {
                    const response = await fetch('/api/add-food', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            category: mealTypeInput.value,
                            food: foodData
                        })
                    });
        
                    if (response.ok) {
                        alert('Food added successfully!');
                        addFoodModal.style.display = 'none';
                        form.reset();
                        location.reload();
                    } else {
                        throw new Error('Failed to add food');
                    }
                } catch (error) {
                    alert('Error adding food: ' + error.message);
                }
            });
        
            // Close modal handlers
            document.querySelectorAll('.modal .close').forEach(closeBtn => {
                closeBtn.addEventListener('click', () => {
                    addFoodModal.style.display = 'none';
                    form.reset();
                });
            });
        
            window.addEventListener('click', (e) => {
                if (e.target === addFoodModal) {
                    addFoodModal.style.display = 'none';
                    form.reset();
                }
            });
        });
        </script>

</div>